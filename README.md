üêç Snake AI –Ω–∞ PyTorch
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –∏ —Å–∏–º—É–ª—è—Ü–∏—é –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∏–≥—Ä—ã "–ó–º–µ–π–∫–∞" —Å –ø–æ–º–æ—â—å—é –≥–ª—É–±–æ–∫–æ–≥–æ Q-–æ–±—É—á–µ–Ω–∏—è (DQN). –ú–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è –∏–∑–±–µ–≥–∞—Ç—å —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π –∏ —Å–æ–±–∏—Ä–∞—Ç—å –µ–¥—É –Ω–∞ –∏–≥—Ä–æ–≤–æ–º –ø–æ–ª–µ.

üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
.
‚îú‚îÄ‚îÄ train.py           # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ simulate.py        # –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤ —Å–∏–º—É–ª—è—Ü–∏–∏
‚îú‚îÄ‚îÄ dqn_agent.py       # –ö–ª–∞—Å—Å –∞–≥–µ–Ω—Ç–∞ —Å –ø–∞–º—è—Ç—å—é –∏ Œµ-–∂–∞–¥–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π
‚îú‚îÄ‚îÄ model.py           # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –∫–ª–∞—Å—Å
‚îú‚îÄ‚îÄ SnakeEnv.py        # –°—Ä–µ–¥–∞ –∏–≥—Ä—ã: –ª–æ–≥–∏–∫–∞ –∏–≥—Ä—ã "–ó–º–µ–π–∫–∞"
‚îú‚îÄ‚îÄ runs/              # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º–∞—è –ø–∞–ø–∫–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ–±—É—á–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ run_YYYYMMDD-HHMMSS/
‚îÇ       ‚îú‚îÄ‚îÄ best_model.pth      # –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å
‚îÇ       ‚îú‚îÄ‚îÄ params.json         # –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
‚îÇ       ‚îî‚îÄ‚îÄ training_plot.png   # –ì—Ä–∞—Ñ–∏–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install torch numpy matplotlib pygame

üß† –û–±—É—á–µ–Ω–∏–µ
–î–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–∞–π–ª:
python train.py

–í–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è:
—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å best_model.pth,
—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞ –≤ params.json,
—Å–æ–∑–¥–∞–µ—Ç—Å—è –≥—Ä–∞—Ñ–∏–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

üéÆ –°–∏–º—É–ª—è—Ü–∏—è –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
–£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –Ω—É–∂–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –≤ simulate.py:

python
MODEL_PATH = "runs/run_20250421-173012/best_model.pth"  # —É–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π –ø—É—Ç—å
PARAMS_PATH = "runs/run_20250421-173012/params.json"    # —É–∫–∞–∂–∏—Ç–µ —Å–≤–æ–π –ø—É—Ç—å

–ó–∞–ø—É—Å–∫:
python simulate.py

‚öôÔ∏è –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ params.json –∏ –≤–∫–ª—é—á–∞—é—Ç:

lr ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
gamma ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–∏—Å–∫–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
reward_food, reward_death, reward_idle
start_epsilon, min_epsilon, epsilon_decay_rate
hidden_sizes ‚Äî —Å–ø–∏—Å–æ–∫ —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ–µ–≤ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä [256, 128])

üìà –ü—Ä–∏–º–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è

üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ runs/ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–Ω—ã–º —à—Ç–∞–º–ø–æ–º.

–°–∏–º—É–ª—è—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞–∫ –º–æ–¥–µ–ª—å, —Ç–∞–∫ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏.
